#!/usr/bin/env python3
"""
ะกะบัะธะฟั ะดะปั ะปะตะณะบะพะณะพ ะทะฐะฟััะบะฐ P2P ะฟัะธะปะพะถะตะฝะธั
"""

import subprocess
import sys
import os
import time

def print_header():
    print("""
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ๐ Auto-P2P Network                    โ
โ           ะัะพััะพ ะทะฐะฟัััะธ ะธ ะฟะพะดะบะปััะธัั!              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
""")

def start_network():
    """ะะฐะฟััะบะฐะตั P2P ัะตัั"""
    print_header()
    
    if len(sys.argv) < 2:
        print("๐ ะกัะฟะตั ะฟัะพััะพะน ัะตะถะธะผ - ะฟัะพััะพ ะทะฐะฟัััะธ ะธ ะฒัะต ะฟะพะดะบะปััะธััั!")
        print()
        print("ะัััััะต ะบะพะผะฐะฝะดั:")
        print("  python start_p2p.py auto     - ะะพะบะฐะปัะฝะพะต ะฟะพะดะบะปััะตะฝะธะต (ะฟะพ ัะผะพะปัะฐะฝะธั)")
        print("  python start_p2p.py global   - ะะปะพะฑะฐะปัะฝะพะต ะฟะพะดะบะปััะตะฝะธะต (ะฒะตัั ะผะธั)")
        print("  python start_p2p.py create   - ะกะพะทะดะฐัั ะฝะพะฒัั ัะตัั")
        print("  python start_p2p.py help     - ะะพะบะฐะทะฐัั ะฒัะต ะบะพะผะฐะฝะดั")
        print()
        print("๐ก ะะปั ะฝะพะฒะธัะบะพะฒ: ะฟัะพััะพ ะธัะฟะพะปัะทัะนัะต 'python start_p2p.py auto'")
        print("๐ ะะปั ะณะปะพะฑะฐะปัะฝะพะณะพ ะพะฑัะตะฝะธั: ะธัะฟะพะปัะทัะนัะต 'python start_p2p.py global'")
        return
    
    command = sys.argv[1].lower()
    
    if command == "auto":
        print("๐ ะกัะฟะตั ะฟัะพััะพะน ัะตะถะธะผ - ะฐะฒัะพ-ะฟะพะดะบะปััะตะฝะธะต ะบ ัะตัะธ!")
        print("โณ ะัั ะดะพัััะฟะฝัะต ัะตัะธ...")
        cmd = [sys.executable, "p2p_app.py"]
        subprocess.run(cmd)
        
    elif command == "global":
        print("๐ ะะปะพะฑะฐะปัะฝัะน ัะตะถะธะผ - ะฟะพะธัะบ ัะตัะตะน ะฟะพ ะฒัะตะผั ะผะธัั!")
        print("โณ ะัั ัะทะปั ะฒ ะณะปะพะฑะฐะปัะฝะพะน ัะตัะธ...")
        cmd = [sys.executable, "p2p_app.py", "--global-mode"]
        subprocess.run(cmd)
        
    elif command == "create":
        if len(sys.argv) < 3:
            print("โ ะฃะบะฐะถะธัะต ะฟะพัั ะดะปั ัะพะทะดะฐะฝะธั ัะตัะธ")
            print("ะัะธะผะตั: python start_p2p.py create 5555")
            return
        
        port = sys.argv[2]
        print(f"๐ ะกะพะทะดะฐะฝะธะต ะฝะพะฒะพะน ัะตัะธ ะฝะฐ ะฟะพััั {port}")
        print("ะะพะผะฐะฝะดั ะฒ ัะตัะธ:")
        print("  send <ัะตะบัั>   - ะพัะฟัะฐะฒะธัั ัะพะพะฑัะตะฝะธะต")
        print("  ping          - ะฟัะพะฒะตัะธัั ะดะพัััะฟะฝะพััั ะฟะธัะพะฒ")
        print("  list          - ะฟะพะบะฐะทะฐัั ัะฟะธัะพะบ ะฟะธัะพะฒ")
        print("  help          - ะฟะพะบะฐะทะฐัั ะฟะพะผะพัั")
        print("  quit          - ะฒัะนัะธ")
        print("-" * 40)
        
        # ะะฐะฟััะบะฐะตะผ ะฟัะธะปะพะถะตะฝะธะต ะบะฐะบ ะณะปะฐะฒะฝัะน ัะทะตะป
        cmd = [sys.executable, "p2p_app.py", "--port", port]
        subprocess.run(cmd)
        
    elif command == "join":
        if len(sys.argv) < 4:
            print("โ ะฃะบะฐะถะธัะต ัะพัั ะธ ะฟะพัั ะดะปั ะฟะพะดะบะปััะตะฝะธั")
            print("ะัะธะผะตั: python start_p2p.py join 127.0.0.1 5555")
            return
        
        host = sys.argv[2]
        port = sys.argv[3]
        print(f"๐ ะะพะดะบะปััะตะฝะธะต ะบ ัะตัะธ {host}:{port}")
        print("๐ ะกะตัั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒะพัััะฐะฝะพะฒะธััั, ะตัะปะธ ัะทะปั ะพัะบะปััะฐััั")
        
        # ะะฐะฟััะบะฐะตะผ ะฟัะธะปะพะถะตะฝะธะต ั ะฟะพะดะดะตัะถะบะพะน ะฝะตัะบะพะปัะบะธั bootstrap ัะทะปะพะฒ
        cmd = [sys.executable, "p2p_app.py", "--bootstrap", f"{host}:{port}"]
        subprocess.run(cmd)
        
    elif command == "mesh":
        if len(sys.argv) < 4:
            print("โ ะฃะบะฐะถะธัะต ะฝะตัะบะพะปัะบะพ ัะพััะพะฒ ะธ ะฟะพััะพะฒ ะดะปั ัะพะทะดะฐะฝะธั mesh ัะตัะธ")
            print("ะัะธะผะตั: python start_p2p.py mesh 127.0.0.1:5555 127.0.0.1:5556 127.0.0.1:5557")
            return
        
        bootstrap_nodes = sys.argv[2:]
        print(f"๐ธ๏ธ  ะกะพะทะดะฐะฝะธะต mesh ัะตัะธ ั ัะทะปะฐะผะธ: {', '.join(bootstrap_nodes)}")
        print("๐ ะะพะปะฝะฐั ะดะตัะตะฝััะฐะปะธะทะฐัะธั - ะฝะตั ะตะดะธะฝะพะน ัะพัะบะธ ะพัะบะฐะทะฐ!")
        
        # ะะฐะฟััะบะฐะตะผ ะฟัะธะปะพะถะตะฝะธะต ัะพ ะฒัะตะผะธ ัะทะปะฐะผะธ ะบะฐะบ bootstrap
        bootstrap_str = ' '.join(bootstrap_nodes)
        cmd = [sys.executable, "p2p_app.py", "--bootstrap"] + bootstrap_nodes
        subprocess.run(cmd)
        
    elif command == "help":
        print_header()
        print("๐ ะัััััะต ะบะพะผะฐะฝะดั:")
        print("  python start_p2p.py auto     - ะะพะบะฐะปัะฝะพะต ะฟะพะดะบะปััะตะฝะธะต (ะฟะพ ัะผะพะปัะฐะฝะธั)")
        print("  python start_p2p.py global   - ะะปะพะฑะฐะปัะฝะพะต ะฟะพะดะบะปััะตะฝะธะต (ะฒะตัั ะผะธั)")
        print("  python start_p2p.py create   - ะกะพะทะดะฐัั ะฝะพะฒัั ัะตัั")
        print("  python start_p2p.py join     - ะะพะดะบะปััะธัััั ะบ ัะตัะธ")
        print("  python start_p2p.py mesh     - ะกะพะทะดะฐัั mesh ัะตัั")
        print("  python start_p2p.py help     - ะะพะบะฐะทะฐัั ััั ัะฟัะฐะฒะบั")
        print("\n๐ก ะะปั ะฝะพะฒะธัะบะพะฒ:")
        print("  python start_p2p.py auto     - ะัะพััะพ ะทะฐะฟัััะธ ะธ ะฒัะต ะฟะพะดะบะปััะธััั!")
        print("  python start_p2p.py global   - ะะฑัะฐะนัั ั ะปัะดัะผะธ ะฟะพ ะฒัะตะผั ะผะธัั!")
        print("\n๐ฌ ะะปั ะฟัะพะดะฒะธะฝัััั:")
        print("  python start_p2p.py create 5555")
        print("  python start_p2p.py join 127.0.0.1 5555")
        print("  python start_p2p.py mesh 127.0.0.1:5555 127.0.0.1:5556")
        
    else:
        print(f"โ ะะตะธะทะฒะตััะฝะฐั ะบะพะผะฐะฝะดะฐ: {command}")
        print("ะัะฟะพะปัะทัะนัะต 'python start_p2p.py help' ะดะปั ัะฟัะฐะฒะบะธ")

if __name__ == "__main__":
    start_network()